{"ast":null,"code":"var _jsxFileName = \"D:\\\\web project\\\\todoList\\\\client\\\\src\\\\components\\\\KakaoLogin.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport axios from 'axios';\nimport { useNavigate } from \"react-router-dom\";\nimport { REST_API_KEY, REDIRECT_URI } from \"../LoginData\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst KakaoRedirectHandler = () => {\n  _s();\n\n  const KAKAO_AUTH_URL = `https://kauth.kakao.com/oauth/authorize?client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&response_type=code`;\n  const navigate = useNavigate();\n  React.useEffect(() => {\n    let params = new URL(window.location.href).searchParams.get(\"code\");\n    let grant_type = \"authorization_code\";\n\n    const getProfile = async () => {\n      try {\n        let data = await window.Kakao.API.request({\n          url: \"/v2/user/me\"\n        });\n        localStorage.setItem(\"user_email\", data.kakao_account.email);\n        localStorage.setItem(\"loginType\", 1);\n        axios.post(\"/api/login\", {\n          param: [{\n            email: data.kakao_account.email,\n            nickname: data.kakao_account.profile.nickname\n          }, {\n            nickname: data.kakao_account.profile.nickname\n          }]\n        }).then(() => {\n          navigate(\"/\");\n        });\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    axios.post(`https://kauth.kakao.com/oauth/token?grant_type=${grant_type}&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&code=${params}`, {\n      headers: {\n        'Content-type': 'application/x-www-form-urlencoded;charset=utf-8'\n      }\n    }).then(res => {\n      window.Kakao.init(REST_API_KEY);\n      window.Kakao.Auth.setAccessToken(res.data.access_token);\n      getProfile();\n    });\n  }, [navigate]);\n  return /*#__PURE__*/_jsxDEV(\"a\", {\n    href: KAKAO_AUTH_URL,\n    children: /*#__PURE__*/_jsxDEV(\"img\", {\n      src: require(\"../icons/kakao.png\"),\n      style: {\n        height: \"30px\",\n        width: \"auto\"\n      },\n      alt: \"...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n};\n\n_s(KakaoRedirectHandler, \"0pNeyzXk/ByIxyERsdaIrG6js9s=\", false, function () {\n  return [useNavigate];\n});\n\n_c = KakaoRedirectHandler;\nexport default KakaoRedirectHandler;\n\nvar _c;\n\n$RefreshReg$(_c, \"KakaoRedirectHandler\");","map":{"version":3,"names":["React","axios","useNavigate","REST_API_KEY","REDIRECT_URI","KakaoRedirectHandler","KAKAO_AUTH_URL","navigate","useEffect","params","URL","window","location","href","searchParams","get","grant_type","getProfile","data","Kakao","API","request","url","localStorage","setItem","kakao_account","email","post","param","nickname","profile","then","err","console","log","headers","res","init","Auth","setAccessToken","access_token","require","height","width"],"sources":["D:/web project/todoList/client/src/components/KakaoLogin.js"],"sourcesContent":["import React from \"react\";\r\nimport axios from 'axios';\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport { REST_API_KEY, REDIRECT_URI } from \"../LoginData\";\r\n\r\nconst KakaoRedirectHandler = () => {\r\n  const KAKAO_AUTH_URL = `https://kauth.kakao.com/oauth/authorize?client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&response_type=code`\r\n  const navigate = useNavigate();\r\n  React.useEffect(()=> {\r\n    let params = new URL(window.location.href).searchParams.get(\"code\");\r\n    let grant_type = \"authorization_code\";\r\n    \r\n    const getProfile = async () => {\r\n      try {\r\n        let data = await window.Kakao.API.request({url: \"/v2/user/me\"});\r\n        localStorage.setItem(\"user_email\", data.kakao_account.email);\r\n        localStorage.setItem(\"loginType\", 1);\r\n        axios.post(\"/api/login\", {\r\n          param:[\r\n            {email: data.kakao_account.email, nickname: data.kakao_account.profile.nickname},\r\n            {nickname: data.kakao_account.profile.nickname}\r\n          ]\r\n        }).then(() => {navigate(\"/\")});\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    axios.post(`https://kauth.kakao.com/oauth/token?grant_type=${grant_type}&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&code=${params}`\r\n      , {\r\n      headers: {\r\n          'Content-type': 'application/x-www-form-urlencoded;charset=utf-8'\r\n      }\r\n    }).then((res) => {\r\n      window.Kakao.init(REST_API_KEY);\r\n      window.Kakao.Auth.setAccessToken(res.data.access_token);\r\n      getProfile();\r\n      \r\n    })\r\n\r\n    }, [navigate])\r\n  return (\r\n    <a href={KAKAO_AUTH_URL}>\r\n      <img \r\n        src={require(\"../icons/kakao.png\")} \r\n        style={{height:\"30px\", width:\"auto\"}} \r\n        alt=\"...\" />\r\n    </a>\r\n  );\r\n};\r\n\r\nexport default KakaoRedirectHandler;"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,WAAR,QAA0B,kBAA1B;AACA,SAASC,YAAT,EAAuBC,YAAvB,QAA2C,cAA3C;;;AAEA,MAAMC,oBAAoB,GAAG,MAAM;EAAA;;EACjC,MAAMC,cAAc,GAAI,qDAAoDH,YAAa,iBAAgBC,YAAa,qBAAtH;EACA,MAAMG,QAAQ,GAAGL,WAAW,EAA5B;EACAF,KAAK,CAACQ,SAAN,CAAgB,MAAK;IACnB,IAAIC,MAAM,GAAG,IAAIC,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,IAAxB,EAA8BC,YAA9B,CAA2CC,GAA3C,CAA+C,MAA/C,CAAb;IACA,IAAIC,UAAU,GAAG,oBAAjB;;IAEA,MAAMC,UAAU,GAAG,YAAY;MAC7B,IAAI;QACF,IAAIC,IAAI,GAAG,MAAMP,MAAM,CAACQ,KAAP,CAAaC,GAAb,CAAiBC,OAAjB,CAAyB;UAACC,GAAG,EAAE;QAAN,CAAzB,CAAjB;QACAC,YAAY,CAACC,OAAb,CAAqB,YAArB,EAAmCN,IAAI,CAACO,aAAL,CAAmBC,KAAtD;QACAH,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkC,CAAlC;QACAvB,KAAK,CAAC0B,IAAN,CAAW,YAAX,EAAyB;UACvBC,KAAK,EAAC,CACJ;YAACF,KAAK,EAAER,IAAI,CAACO,aAAL,CAAmBC,KAA3B;YAAkCG,QAAQ,EAAEX,IAAI,CAACO,aAAL,CAAmBK,OAAnB,CAA2BD;UAAvE,CADI,EAEJ;YAACA,QAAQ,EAAEX,IAAI,CAACO,aAAL,CAAmBK,OAAnB,CAA2BD;UAAtC,CAFI;QADiB,CAAzB,EAKGE,IALH,CAKQ,MAAM;UAACxB,QAAQ,CAAC,GAAD,CAAR;QAAc,CAL7B;MAMD,CAVD,CAUE,OAAOyB,GAAP,EAAY;QACZC,OAAO,CAACC,GAAR,CAAYF,GAAZ;MACD;IACF,CAdD;;IAgBA/B,KAAK,CAAC0B,IAAN,CAAY,kDAAiDX,UAAW,cAAab,YAAa,iBAAgBC,YAAa,SAAQK,MAAO,EAA9I,EACI;MACF0B,OAAO,EAAE;QACL,gBAAgB;MADX;IADP,CADJ,EAKGJ,IALH,CAKSK,GAAD,IAAS;MACfzB,MAAM,CAACQ,KAAP,CAAakB,IAAb,CAAkBlC,YAAlB;MACAQ,MAAM,CAACQ,KAAP,CAAamB,IAAb,CAAkBC,cAAlB,CAAiCH,GAAG,CAAClB,IAAJ,CAASsB,YAA1C;MACAvB,UAAU;IAEX,CAVD;EAYC,CAhCH,EAgCK,CAACV,QAAD,CAhCL;EAiCA,oBACE;IAAG,IAAI,EAAED,cAAT;IAAA,uBACE;MACE,GAAG,EAAEmC,OAAO,CAAC,oBAAD,CADd;MAEE,KAAK,EAAE;QAACC,MAAM,EAAC,MAAR;QAAgBC,KAAK,EAAC;MAAtB,CAFT;MAGE,GAAG,EAAC;IAHN;MAAA;MAAA;MAAA;IAAA;EADF;IAAA;IAAA;IAAA;EAAA,QADF;AAQD,CA5CD;;GAAMtC,oB;UAEaH,W;;;KAFbG,oB;AA8CN,eAAeA,oBAAf"},"metadata":{},"sourceType":"module"}